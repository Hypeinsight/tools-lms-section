<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Toolsâ„¢ Learning Journey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1440px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .component {
            display: none;
            width: 100%;
            position: relative;
            min-height: 100vh;
        }

        .component.active {
            display: block;
        }

        /* Make SVGs responsive */
        .component svg {
            width: 100%;
            height: auto;
            display: block;
            vertical-align: top;
            margin-bottom: 0;
        }

        /* Reorder Module 1 Completed view - adjust viewBox to show tools interface first */
        #component-2 svg {
            transform: translateY(-650px);
        }

        #component-2 {
            padding-top: 650px;
            overflow: hidden;
        }

        /* Loading state */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            font-size: 18px;
            color: #666;
        }

        /* Clickable overlay areas - positioned absolutely over SVG buttons */
        .click-overlay {
            position: absolute;
            cursor: pointer;
            z-index: 10;
            /* Uncomment below to debug positioning */
            /* background: rgba(255, 0, 0, 0.3); */
        }

        .click-overlay:hover {
            /* Subtle hover effect - optional */
            /* background: rgba(255, 255, 255, 0.1); */
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="component-container">
            <div class="loading">Loading components...</div>
        </div>
    </div>

    <script>
        // Component configuration
        const components = [
            { id: 'component-7', file: 'svg/Component 7.svg', name: 'Landing' },
            { id: 'component-2', file: 'new svg/Component 2.svg', name: 'Module 1 Completed' },
            { id: 'component-9', file: 'svg/Component 9.svg', name: 'Competency 2.1' },
            { id: 'component-10', file: 'svg/Component 10.svg', name: 'Competency 2.2' },
            { id: 'component-11', file: 'svg/Component 11.svg', name: 'Competency 3.1' },
            { id: 'component-12', file: 'svg/Component 12.svg', name: 'Competency 3.2' },
            { id: 'component-13', file: 'svg/Component 13.svg', name: 'Completion' }
        ];

        // SVG dimensions for percentage calculations
        const SVG_WIDTH = 1440;
        
        // Progress circle positions (from SVG analysis)
        // These are the 5 competency circles at the top of each SVG
        const circlePositions = [
            { x: 171.5, y: 80.5, width: 69, height: 69, targetIndex: 1 },   // Circle 1 -> Component 8
            { x: 428, y: 80.5, width: 68, height: 69, targetIndex: 2 },     // Circle 2.1 -> Component 9
            { x: 683.5, y: 80.5, width: 69, height: 69, targetIndex: 3 },   // Circle 2.2 -> Component 10
            { x: 940, y: 80.5, width: 68, height: 69, targetIndex: 4 },     // Circle 3.1 -> Component 11
            { x: 1195, y: 80.5, width: 70, height: 69, targetIndex: 5 }     // Circle 3.2 -> Component 12
        ];

        // Button positions for each component (from SVG analysis)
        // Component 7: START NOW button only
        // Components 8-12: BACK and NEXT buttons
        // Component 13: No navigation buttons (completion)
        const buttonConfigs = {
            0: [ // Component 7 (Landing) - height: 1125
                { x: 160, y: 889, width: 194, height: 56, action: 'next' } // START NOW
            ],
            1: [ // Component 2 (Module 1 Completed) - height: 2174
                { x: 77.5, y: 2068, width: 142, height: 56, action: 'back' },  // BACK
                { x: 1219, y: 2068, width: 141, height: 56, action: 'next' }   // NEXT
            ],
            2: [ // Component 9 - height: 1350
                { x: 80, y: 1214, width: 142, height: 56, action: 'back' },
                { x: 1220, y: 1214, width: 141, height: 56, action: 'next' }
            ],
            3: [ // Component 10 - height: 2902
                { x: 80, y: 2766, width: 142, height: 56, action: 'back' },
                { x: 1220, y: 2766, width: 141, height: 56, action: 'next' }
            ],
            4: [ // Component 11 - height: 1418
                { x: 80, y: 1282, width: 142, height: 56, action: 'back' },
                { x: 1220, y: 1282, width: 141, height: 56, action: 'next' }
            ],
            5: [ // Component 12 - height: 1756
                { x: 80, y: 1620, width: 142, height: 56, action: 'back' },
                { x: 1220, y: 1620, width: 141, height: 56, action: 'next' }
            ],
            6: [] // Component 13 (Completion) - height: 993, no nav buttons
        };

        let currentIndex = 0;
        let componentsLoaded = false;

        // Load all SVG components
        async function loadComponents() {
            const container = document.getElementById('component-container');
            container.innerHTML = '';

            for (let i = 0; i < components.length; i++) {
                const comp = components[i];
                try {
                    const response = await fetch(comp.file);
                    const svgText = await response.text();
                    
                    const componentDiv = document.createElement('div');
                    componentDiv.className = `component ${i === 0 ? 'active' : ''}`;
                    componentDiv.id = comp.id;
                    componentDiv.innerHTML = svgText;
                    
                    container.appendChild(componentDiv);
                    
                    // Add clickable overlays after SVG is loaded
                    addClickableOverlays(componentDiv, i);
                    
                } catch (error) {
                    console.error(`Error loading ${comp.file}:`, error);
                }
            }

            componentsLoaded = true;
        }

        // Add clickable overlay elements to a component
        function addClickableOverlays(componentDiv, componentIndex) {
            const svg = componentDiv.querySelector('svg');
            if (!svg) return;

            // Get the viewBox to understand the coordinate system
            const viewBox = svg.getAttribute('viewBox');
            let svgHeight = 1125; // default for Component 7
            
            if (viewBox) {
                const parts = viewBox.split(' ');
                svgHeight = parseFloat(parts[3]);
            } else {
                // Try to get height from height attribute
                const heightAttr = svg.getAttribute('height');
                if (heightAttr) {
                    svgHeight = parseFloat(heightAttr);
                }
            }

            // Add circle overlays (for navigation to specific competencies)
            // Only add if not on completion page
            if (componentIndex < 6) {
                circlePositions.forEach(circle => {
                    const overlay = createOverlay(circle.x, circle.y, circle.width, circle.height, svgHeight);
                    overlay.onclick = () => navigateTo(circle.targetIndex);
                    overlay.title = `Go to ${components[circle.targetIndex].name}`;
                    componentDiv.appendChild(overlay);
                });
            }

            // Add button overlays for this component
            const buttons = buttonConfigs[componentIndex] || [];
            buttons.forEach(btn => {
                const overlay = createOverlay(btn.x, btn.y, btn.width, btn.height, svgHeight);
                
                if (btn.action === 'next') {
                    overlay.onclick = () => navigateTo(currentIndex + 1);
                    overlay.title = componentIndex === 0 ? 'START NOW' : 'NEXT';
                } else if (btn.action === 'back') {
                    overlay.onclick = () => navigateTo(currentIndex - 1);
                    overlay.title = 'BACK';
                }
                
                componentDiv.appendChild(overlay);
            });
        }

        // Create a clickable overlay element with percentage-based positioning
        function createOverlay(x, y, width, height, svgHeight) {
            const overlay = document.createElement('div');
            overlay.className = 'click-overlay';
            
            // Convert absolute positions to percentages
            overlay.style.left = ((x / SVG_WIDTH) * 100) + '%';
            overlay.style.top = ((y / svgHeight) * 100) + '%';
            overlay.style.width = ((width / SVG_WIDTH) * 100) + '%';
            overlay.style.height = ((height / svgHeight) * 100) + '%';
            
            return overlay;
        }

        // Navigate to a specific component
        function navigateTo(index) {
            if (index < 0 || index >= components.length) return;
            
            // Hide current component
            const currentComponent = document.querySelector('.component.active');
            if (currentComponent) {
                currentComponent.classList.remove('active');
            }

            // Show new component
            currentIndex = index;
            const newComponent = document.getElementById(components[index].id);
            if (newComponent) {
                newComponent.classList.add('active');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!componentsLoaded) return;
            
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                navigateTo(currentIndex + 1);
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                navigateTo(currentIndex - 1);
            } else if (e.key >= '1' && e.key <= '7') {
                navigateTo(parseInt(e.key) - 1);
            }
        });

        // Initialize
        loadComponents();
    </script>
</body>
</html>
