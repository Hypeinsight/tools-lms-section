<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EDU Practical Guide â€” Implementation (RMIT)</title>
  <style>
    :root {
      --max-w: 1440px;
    }
    html, body { margin: 0; padding: 0; background:transparent; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#111; }
    .page { display:flex; justify-content:center; padding:0; }
    .container { position:relative; width:100%; max-width: var(--max-w); background:#F0F0F0; border-radius:8px; box-shadow:0 10px 40px rgba(0,0,0,0.25); }

    .component { display:none; position:relative; background:#F0F0F0; }
    .component.active { display:block; }

    .svg-host { position:relative; width:100%; height:auto; display:block; background:#F0F0F0; }
    .svg-host img { width:100%; height:auto; display:block; }

    /* overlay root sits above the image in the svg-host */
    .overlay-root { position:absolute; top:0; left:0; right:0; bottom:0; pointer-events:none; z-index:10; }
    .click-area { position:absolute; border-radius:8px; pointer-events:auto; cursor:pointer; }
  </style>
</head>
<body>
  <div class="page">
    <div class="container">
      <!-- components injected here by JS -->
    </div>
  </div>

  <script>
    /**
     * Helper: create a component block that embeds an external SVG via <img>,
     * then positions overlays using percent based on the SVG's viewBox.
     */

    // No progress bar navigation - only Back/Next buttons

    const components = [
      // Slide 1 - Practical Exercises
      {
        id: 1,
        file: "EDU Practical Guide (Implementation)/1 - Practical Exercises.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1249,
        overlays: [
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "next", x: 1173, y: 1133, w: 207, h: 56 }
        ]
      },
      // Slide 2 - Compare Tools vs. to NCC AS
      {
        id: 2,
        file: "EDU Practical Guide (Implementation)/2 - Compare Tools vs. to NCC AS.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1003,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/QanA9p?click=t&type=1", x: 176.734, y: 585, w: 148.61, h: 24 },
          { action: "url", url: "https://ncc.abcb.gov.au/editions/ncc-2022/adopted/housing-provisions/11-safe-movement-and-access/part-112-stairway-and-ramp-construction", x: 366.359, y: 661, w: 196.633, h: 24 },
          { action: "back", x: 60, y: 823, w: 142, h: 56 },
          { action: "next", x: 1199, y: 823, w: 181, h: 56 }
        ]
      },
      // Slide 3 - Foundational Tools for Education
      {
        id: 3,
        file: "EDU Practical Guide (Implementation)/3 - Foundational Tools for Education.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 6092,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/O8KA6i?click=t&type=0", x: 60, y: 750, w: 112.992, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/1dFHmF?click=t&type=0", x: 495, y: 750, w: 179.078, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/A3SFQB?click=t&type=0", x: 930, y: 750, w: 135.23, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/8hP79t?click=t&type=0", x: 60, y: 1211, w: 138.844, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/coPw0x?click=t&type=0", x: 495, y: 1211, w: 188.703, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/QWf1AE?click=t&type=0", x: 60, y: 1680, w: 177.953, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/QWf1AE?click=t&type=0", x: 495, y: 1680, w: 107.641, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/DK8Vkg?click=t&type=0", x: 60, y: 2239, w: 153.938, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/4p7zvK?click=t&type=0", x: 495, y: 2239, w: 135.266, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/Y1nusV?click=t&type=0", x: 930, y: 2239, w: 140.88, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/8ssGTH?click=t&type=0", x: 60, y: 2692, w: 194.594, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/zw1WIX?click=t&type=0", x: 495, y: 2692, w: 143.312, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/jL1etk?click=t&type=0", x: 930, y: 2692, w: 156.31, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/McNQZz?click=t&type=0", x: 60, y: 3019, w: 168.203, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/ov1MV0?click=t&type=1", x: 60, y: 3424, w: 144.188, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/BBx5nM?click=t&type=0", x: 495, y: 3424, w: 183.391, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/mBw3Mf?click=t&type=0", x: 930, y: 3424, w: 75.62, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/E3N0Ja?click=t&type=0", x: 60, y: 3829, w: 322.094, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/fU2Fxg?click=t&type=0", x: 495, y: 3829, w: 143.25, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/X38YLW?click=t&type=0", x: 930, y: 3829, w: 131.67, h: 20 },
          { action: "back", x: 60, y: 5948, w: 142, h: 56 },
          { action: "next", x: 1198, y: 5948, w: 182, h: 56 }
        ]
      },
      // Slide 4 - Embed Tools into Current Lesson Plans
      {
        id: 4,
        file: "EDU Practical Guide (Implementation)/4 - Embed Tools into Current Lesson Plans.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1020,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "back", x: 60, y: 904, w: 142, h: 56 },
          { action: "next", x: 1198, y: 904, w: 182, h: 56 }
        ]
      },
      // Slide 5 - Playlists
      {
        id: 5,
        file: "EDU Practical Guide (Implementation)/5 - Playlists.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1042,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "gif", url: "EDU Practical Guide (Implementation)/GIF/image (9).gif", x: 748, y: 338, w: 632, h: 487 },
          { action: "back", x: 60, y: 926, w: 142, h: 56 },
          { action: "next", x: 1199, y: 926, w: 181, h: 56 }
        ]
      },
      // Slide 6 - Real Life vs. Code
      {
        id: 6,
        file: "EDU Practical Guide (Implementation)/6 - Real Life vs. Code.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 2323,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/sEiPKa?click=t&type=0", x: 119.641, y: 422, w: 172.625, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/eUxoLN?click=t&type=0", x: 119.641, y: 948, w: 162.914, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/McNQZz?click=t&type=0", x: 494.422, y: 1474, w: 137.32, h: 20 },
          { action: "back", x: 60, y: 2207, w: 142, h: 56 },
          { action: "next", x: 1198, y: 2207, w: 182, h: 56 }
        ]
      },
      // Slide 7 - Treasure Hunt
      {
        id: 7,
        file: "EDU Practical Guide (Implementation)/7 - Treasure Hunt.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 3243,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/HlTJg5?click=t&type=0", x: 292, y: 530, w: 188, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/TBSqx4?click=t&type=0", x: 288, y: 1374, w: 168, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/SgRi8P?click=t&type=0", x: 472, y: 2208, w: 210, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/Afpu9J?click=t&type=1", x: 666.102, y: 1374, w: 31.195, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/7GYnRx?click=t&type=0", x: 880.602, y: 2208, w: 30.609, h: 20 },
          { action: "back", x: 60, y: 3127, w: 142, h: 56 },
          { action: "next", x: 1199, y: 3127, w: 181, h: 56 }
        ]
      },
      // Slide 8 - Discuss best Practices
      {
        id: 8,
        file: "EDU Practical Guide (Implementation)/8 - Discuss best Practices.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 3039,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/31C7Di?click=t&type=0", x: 421.281, y: 530, w: 199.383, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/Jo9Mbl?click=t&type=0", x: 757.906, y: 1324, w: 276.764, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/8VOkqY?click=t&type=0", x: 223, y: 2111, w: 139, h: 20 },
          { action: "back", x: 60, y: 2923, w: 142, h: 56 },
          { action: "next", x: 1198, y: 2923, w: 182, h: 56 }
        ]
      },
      // Slide 9 - Student Presentation
      {
        id: 9,
        file: "EDU Practical Guide (Implementation)/9 - Student Presentation.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1081,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://swinburne.buildingtools.co/tools/site-works-pool-safety-fence-gate?v=1&menu_id=5-6&shareId=ch6ODI-1761100718604&zoom=2.1048519522998363&x=495.0831070206157&y=310.2727794476419", x: 118, y: 570, w: 45.094, h: 48 },
          { action: "url", url: "https://buildingtools.co/r/sJq2L6?click=t&type=0", x: 167.547, y: 598, w: 85.422, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/sJq2L6?click=t&type=0", x: 934, y: 258, w: 42, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/HVkThH?click=t&type=0", x: 261.875, y: 598, w: 89.867, h: 20 },
          { action: "back", x: 60, y: 965, w: 142, h: 56 },
          { action: "next", x: 1198, y: 965, w: 182, h: 56 }
        ]
      },
      // Slide 10 - SpecBlock Demo
      {
        id: 10,
        file: "EDU Practical Guide (Implementation)/10 - SpecBlock Demo.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1019,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/install-tools-revit-add-on/", x: 415.984, y: 376, w: 39.209, h: 20 },
          { action: "back", x: 60, y: 903, w: 142, h: 56 },
          { action: "next", x: 1191, y: 903, w: 189, h: 56 }
        ]
      },
      // Slide 11 - Safety, Risk and Liability
      {
        id: 11,
        file: "EDU Practical Guide (Implementation)/11 - Safety, Risk and Liability.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1269,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "url", url: "https://buildingtools.co/r/9cirGa?click=t&type=0", x: 205.203, y: 540, w: 142.594, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/Q9hPDG?click=t&type=0", x: 210.164, y: 578, w: 116.969, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/KwdAG2?click=t&type=0", x: 265.484, y: 616, w: 163.735, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/6tgg0a?click=t&type=0", x: 400.75, y: 644, w: 36.469, h: 20 },
          { action: "url", url: "https://buildingtools.co/r/1h41LS?click=t&type=1", x: 382.391, y: 710, w: 72.078, h: 20 },
          { action: "back", x: 60, y: 1153, w: 142, h: 56 },
          { action: "next", x: 1193, y: 1153, w: 187, h: 56 }
        ]
      },
      // Slide 12 - Critical Thinking
      {
        id: 12,
        file: "EDU Practical Guide (Implementation)/12 - Critical Thinking.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 1391,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "next", x: 1293, y: 80, w: 50, h: 50 },
          { action: "back", x: 60, y: 1275, w: 142, h: 56 },
          { action: "next", x: 1156, y: 1275, w: 224, h: 56 }
        ]
      },
      // Slide 13 - All set
      {
        id: 13,
        file: "EDU Practical Guide (Implementation)/13 - All set.svg",
        viewBoxWidth: 1440,
        viewBoxHeight: 796,
        overlays: [
          { action: "back", x: 101, y: 80, w: 50, h: 50 },
          { action: "back", x: 60, y: 680, w: 142, h: 56 },
          { action: "url", url: "https://rmit.buildingtools.co/", x: 619.016, y: 519, w: 203, h: 56 }
        ]
      }
    ];

    // DOM setup
    const container = document.querySelector('.container');

    const state = {
      index: 0, // 0..12
      loaded: new Array(components.length).fill(false),
      viewBox: new Array(components.length).fill(null) // {w,h}
    };

    function buildDOM() {
      components.forEach((c, i) => {
        const comp = document.createElement('div');
        comp.className = 'component' + (i === 0 ? ' active' : '');
        comp.dataset.idx = i;

        const host = document.createElement('div');
        host.className = 'svg-host';

        const img = document.createElement('img');
        img.src = c.file;
        img.setAttribute('aria-label', `Slide ${c.id}`);

        const overlays = document.createElement('div');
        overlays.className = 'overlay-root';

        host.appendChild(img);
        host.appendChild(overlays);  // Put overlays inside the svg-host
        comp.appendChild(host);
        container.appendChild(comp);

        // Use fixed viewBox dimensions from component config
        state.viewBox[i] = { w: c.viewBoxWidth || 1440, h: c.viewBoxHeight || 2500 };
        
        // Wait for image to load before rendering overlays
        img.addEventListener('load', () => {
          state.loaded[i] = true;
          renderOverlays(i);
        });
      });
    }

    function pct(n, d) { return (n / d) * 100; }

    function renderOverlays(idx) {
      const compEl = container.querySelector(`.component[data-idx="${idx}"]`);
      if (!compEl) return;
      const root = compEl.querySelector('.overlay-root');
      root.innerHTML = '';
      const vb = state.viewBox[idx];
      if (!vb) return; // wait until we know viewbox

      // Get the actual rendered dimensions of the SVG host
      const host = compEl.querySelector('.svg-host');
      
      components[idx].overlays.forEach((o, oi) => {
        // Handle GIF overlays differently
        if (o.action === 'gif') {
          const gifEl = document.createElement('img');
          gifEl.src = o.url;
          gifEl.style.position = 'absolute';
          gifEl.style.left = (o.x / vb.w) * 100 + '%';
          gifEl.style.top = (o.y / vb.h) * 100 + '%';
          gifEl.style.width = (o.w / vb.w) * 100 + '%';
          gifEl.style.height = (o.h / vb.h) * 100 + '%';
          gifEl.style.borderRadius = '32px';
          gifEl.style.objectFit = 'cover';
          gifEl.style.pointerEvents = 'none';
          root.appendChild(gifEl);
          return;
        }
        
        const el = document.createElement('div');
        el.className = 'click-area';
        
        // Convert SVG coordinates to percentage based on viewBox
        let leftPct = (o.x / vb.w) * 100;
        const topPct = (o.y / vb.h) * 100;
        let widthPct = (o.w / vb.w) * 100;
        const heightPct = (o.h / vb.h) * 100;
        
        el.style.left = leftPct + '%';
        el.style.top = topPct + '%';
        el.style.width = widthPct + '%';
        el.style.height = heightPct + '%';
        el.title = o.action.toUpperCase();

        el.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          handleAction(o);
        });

        root.appendChild(el);
      });
    }

    function handleAction(o) {
      if (o.action === 'next') {
        goTo(state.index + 1, 'button');
      } else if (o.action === 'back') {
        goTo(state.index - 1, 'button');
      } else if (o.action === 'url' && o.url) {
        window.open(o.url, '_blank', 'noopener');
      } else if (o.action === 'goto' && Number.isInteger(o.to)) {
        goTo(o.to, 'button');
      } else {
        console.log('Unhandled action:', o);
      }
    }

    function goTo(newIndex, method = 'button') {
      const max = components.length - 1;
      const clamped = Math.max(0, Math.min(max, newIndex));
      if (clamped === state.index) return;
      
      const prevIndex = state.index;
      const prev = container.querySelector(`.component[data-idx="${state.index}"]`);
      const next = container.querySelector(`.component[data-idx="${clamped}"]`);
      if (prev) prev.classList.remove('active');
      if (next) next.classList.add('active');
      state.index = clamped;
      
      // ensure overlays re-render to honor debug toggle
      if (state.viewBox[clamped]) renderOverlays(clamped);
      
      // Notify parent window of new height
      notifyParentHeight();
      
      // Scroll parent window to top
      if (window.parent !== window) {
        window.parent.postMessage({ action: 'scrollToTop' }, '*');
      }
      // Also scroll this window to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    function getComponentName(index) {
      if (components[index]) {
        return components[index].name || `Slide ${components[index].id}`;
      }
      return `Step ${index + 1}`;
    }
    
    function notifyParentHeight() {
      if (window.parent !== window) {
        const currentHeight = components[state.index].viewBoxHeight;
        console.log('Sending height notification:', currentHeight);
        window.parent.postMessage({ 
          action: 'resizeIframe', 
          height: currentHeight 
        }, '*');
      }
    }

    function hookKeyboard() {
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
          e.preventDefault();
          goTo(state.index + 1, 'keyboard');
        } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
          e.preventDefault();
          goTo(state.index - 1, 'keyboard');
        }
      });
    }

    // init
    buildDOM();
    hookKeyboard();
    
    // Notify parent of initial height after DOM is ready
    window.addEventListener('load', () => {
      notifyParentHeight();
    });
  </script>
</body>
</html>
